//
// Created by sine on 19-1-15.
//

#ifndef SWEETPOTATO_SIP_INVITE_H
#define SWEETPOTATO_SIP_INVITE_H
//https://blog.csdn.net/zqixiao_09/article/details/79519335
/**基本呼叫建立
    +---------------------------------------------------------+
        终端代理A             代理服务器            终端代理B
    +       |---Invite(1)     -->|                    |       +
    +       |                    |--Invite(2)      -->|       +
    +       |<--100Trying(3)  ---|                    |       +
    +       |                    |<--100 Trying(4) ---|       +
    +       |                    |<--180 Ringing(5)---|       +
    +       |<--180 Ringing(6)---|                    |       +
    +       |                    |<--200 OK(7)     ---|       +
    +       |<--200 OK(8)     ---|                    |       +
    +       |---ACK(9)        -->|                    |       +
    +       |                    |---ACK(10)       -->|       +
    +                                                         +
    +       |<---------------calling--------------- ->|       +
    +---------------------------------------------------------+
    */


/**正常呼叫释放过程
    +-------------------------------------------------------+
        终端代理A             代理服务器            终端代理B
    +       |<---------------calling--------------->|       +
    +       |                   |<--Bye(1)       ---|       +
    +       |<--Bye(2)       ---|                   |       +
    +       |---200 OK(3)    -->|                   |       +
    +       |                   |---200 OK(4)     ->|       +
    +                                                       +
    +-------------------------------------------------------+
 */

/**被叫忙呼叫释放
    +-------------------------------------------------------------+
        终端代理A             代理服务器            终端代理B
    +       |---Invite(1)       -->|                      |       +
    +       |                      |--Invite(2)        -->|       +
    +       |<--100 Trying(3)   ---|                      |       +
    +       |                      |<--100 Trying(4)   ---|       +
    +       |                      |<--486 Busy here(5)---|       +
    +       |<--486 Busy here(6)---|                      |       +
    +       |---ACK(7)          -->|                      |       +
    +       |                      |---ACK(8)          -->|       +
    +                                                             +
    +-------------------------------------------------------------+
    */

/**被叫无应答流程一
    +-----------------------------------------------------------------------------+
        终端代理A                       代理服务器                     终端代理B
    +       |---Invite(1)               -->|                              |       +
    +       |                              |--Invite(2)                -->|       +
    +       |<--100 Trying(3)           ---|                              |       +
    +       |                              |<--100 Trying(4)           ---|       +
    +       |                              |<--180 Ringing(5)          ---|       +
    +       |<--180 Ringing(6)          ---|                              |       +
    +       |---Cancel(7)               -->|                              |       +
    +       |                              |--Cancel(8)                -->|       +
    +       |<--200 OK(9)               ---|                              |       +
    +       |                              |<--200 OK(10)              ---|       +
    +       |                              |<--487 Request Canceled(11)---|       +
    +       |<--487 Request Canceled(12)---|                              |       +
    +       |                              |---ACK(12)                 -->|       +
    +       |---ACK(13)                 -->|                              |       +
    +                                                                             +
    +-----------------------------------------------------------------------------+
    */

/**被叫无应答流程二
    +-----------------------------------------------------------------------------+
        终端代理A                       代理服务器                     终端代理B
    +       |---Invite(1)               -->|                              |       +
    +       |                              |--Invite(2)                -->|       +
    +       |<--100 Trying(3)           ---|                              |       +
    +       |                              |<--100 Trying(4)           ---|       +
    +       |                              |<--180 Ringing(5)          ---|       +
    +       |<--180 Ringing(6)          ---|                              |       +
    +       |                              |<--408 Request timeout(7)  ---|       +
    +       |<--408 Request timeout(8)  ---|                              |       +
    +       |                              |---ACK(9)                  -->|       +
    +       |---ACK(10)                 -->|                              |       +
    +                                                                             +
    +-----------------------------------------------------------------------------+
    */

/**遇忙呼叫前转
    +---------------------------------------------------------------------------+
        终端代理A             代理服务器            终端代理B            终端代理C
    +       |---Invite(1)       -->|                      |               |     +
    +       |                      |--Invite(2)        -->|               |     +
    +       |<--100 Trying(3)   ---|                      |               |     +
    +       |                      |<--100 Trying(4)   ---|               |     +
    +       |                      |<--486 Busy here(5)---|               |     +
    +       |                      |---ACK(6)          -->|               |     +
    +       |                      |--Invite(7)                        -->|     +
    +       |                      |<--180 Ringing(8)                  ---|     +
    +       |<--180 Ringing(9)  ---|                      |               |     +
    +       |                      |<--200 OK(10)                      ---|     +
    +       |<--200 OK(11)      ---|                      |               |     +
    +       |---ACK(12)         -->|                      |               |     +
    +       |                      |---ACK(13)                         -->|     +
    +       |                      |                      |               |     +
    +       |                      -----speaking------                    |     +
    +       |                                                             |     +
    +       |---BYE(14)         -->|                      |               |     +
    +       |                      |---BYE(15)                         -->|     +
    +       |                      |<--200 OK(16)                      ---|     +
    +       |<--200 OK(17)      ---|                      |               |     +
    +---------------------------------------------------------------------------+
    */

/**无应答呼叫前转
    +------------------------------------------------------------------------------------+
        终端代理A              代理服务器                        终端代理B         终端代理C
    +       |---Invite(1)       -->|                               |               |     +
    +       |                      |--Invite(2)                 -->|               |     +
    +       |<--100 Trying(3)   ---|                               |               |     +
    +       |                      |<--100 Trying(4)            ---|               |     +
    +       |                      |<--180 Ringing(5)                           ---|     +
    +       |<--180 Ringing(6)  ---|                               |               |     +
    +       |                      |--Cancel(7)                 -->|               |     +
    +       |                      |<--200 OK(8)                                ---|     +
    +       |                      |<--487 Request Canceled(9)  ---|               |     +
    +       |                      |---ACK(10)                  -->|               |     +
    +       |                      |--Invite(11)                                -->|     +
    +       |                      |<--180 Ringing(12)                          ---|     +
    +       |<--180 Ringing(13) ---|                               |               |     +
    +       |                      |<--200 OK(14)                               ---|     +
    +       |<--200 OK(15)      ---|                               |               |     +
    +       |---ACK(16)         -->|                               |               |     +
    +       |                      |---ACK(17)                                  -->|     +
    +       |                      |                               |               |     +
    +       |                      -----speaking------                             |     +
    +       |                                                                      |     +
    +       |---BYE(18)         -->|                               |               |     +
    +       |                      |---BYE(19)                                  -->|     +
    +       |                      |<--200OK(20)                                ---|     +
    +       |<--200OK(21)       ---|                               |               |     +
    +------------------------------------------------------------------------------------+
    */

/**呼叫保持
    +---------------------------------------------------------------------------+
        终端代理A                       代理服务器                      终端代理B
    +       |---Invite(1)               -->|                            |       +
    +       |                              |--Invite(2)              -->|       +
    +       |<--100Trying(3)            ---|                            |       +
    +       |                              |<--100 Trying(4)         ---|       +
    +       |                              |<--180 Ringing(5)        ---|       +
    +       |<--180 Ringing(6)          ---|                            |       +
    +       |                              |<--200 OK(7)             ---|       +
    +       |<--200 OK(8)               ---|                            |       +
    +       |---ACK(9)                  -->|                            |       +
    +       |                              |---ACK(10)               -->|       +
    +       |                                                           |       +
    +       |<---------------calling----                   ------------>|       +
    +       |                              |<--Invite(c=0.0.0.0)(12) ---|       +
    +       |<--Invie(c=0.0.0.0)(13)    ---|                            |       +
    +       |---200 OK(14)              -->|                            |       +
    +       |                              |---200 OK(15)            -->|       +
    +       |                              |<--ACK(16)               ---|       +
    +       |<--ACK(17)                 ---|                            |       +
    +---------------------------------------------------------------------------+
    */

/**呼叫等待
    +------------------------------------------------------------------------------------+
        终端代理A              代理服务器                        终端代理B         终端代理C
            |                      |                               |
            |<--A,B calling                                     -->|               |     +
    +       |                      |<--Invite(2)                                ---|     +
    +       |                      |---100 Trying(3)                            -->|     +
    +       |<--Invite(4)       ---|                               |               |     +
    +       |---180 Ringing(5)  -->|                               |               |     +
    +       |                      |---180 Ringing(6)                           -->|     +
    +       |---Invite(7)       -->|                               |               |     +
    +       |                      |--Invite(8)                 -->|               |     +
    +       |<--100 Trying(9)   ---|                               |               |     +
    +       |                      |<--200 OK(10)                               ---|     +
    +       |<--200 OK(11)      ---|                               |               |     +
    +       |---ACK(12)         -->|                               |               |     +
    +       |                      |---ACK(13)                                  -->|     +
    +       |---200 OK(14)      -->|                               |               |     +
    +       |                      |---200 OK(15)                               -->|     +
    +       |                      |---ACK(16)                                  -->|     +
    +       |---ACK(17)         -->|                               |               |     +
    +       |                      -----speaking------                             |     +
    +       |                                                                      |     +
    +       |---BYE(18)         -->|                               |               |     +
    +       |                      |---BYE(19)                                  -->|     +
    +       |                      |<--200OK(20)                                ---|     +
    +       |<--200OK(21)       ---|                               |               |     +
    +       |---Invite(22)      -->|                               |               |     +
    +       |                      |--Invite(23)                -->|               |     +
    +------------------------------------------------------------------------------------+
    */

/**会话更改流程
    +----------------------------------------+
        用户代理服务端           用户代理客户端
    +       |---calling(1)        -->|       +
    +       |-->Invite(2)         -->|       +
    +       |<--200 OK(3)         ---|       +
    +       |---ACK(4)            -->|       +
    +----------------------------------------+
 */


#endif //SWEETPOTATO_SIP_INVITE_H
